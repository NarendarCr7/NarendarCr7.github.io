(self.modernJsonp=self.modernJsonp||[]).push([["23063"],{950883:function(e,t,a){a.d(t,{X:()=>r});let r="favorited"},914071:function(e,t,a){a.d(t,{Z:()=>n});var r=a(667294);function n(e,t){let a=(0,r.useRef)([]),[n,o]=(0,r.useState)(),[d,l]=(0,r.useReducer)(n??(()=>t),t),g=(0,r.useCallback)(t=>{n?l(t):(a.current.length||e().then(e=>{o(()=>e.default)}),a.current=[...a.current,t])},[e,n]);return(0,r.useEffect)(()=>{n&&(a.current.forEach(l),a.current=[])},[n]),[d,g]}},105433:function(e,t,a){a.d(t,{pb:()=>f,nf:()=>C,lV:()=>G});var r=a(667294),n=a(581722),o=a(441143),d=a.n(o),l=a(575108),g=a(729434),i=a(686319),_=a(791948),u=a(503246),m=a(991384);let s={feature_map:Object.freeze({})},E=(e,t)=>{let a={...(0,m.Z)(e,t),...t.reaction_counts?{reaction_counts:t.reaction_counts}:Object.freeze({}),...t.tags?{tags:t.tags}:Object.freeze({}),...t.tagged_users?{tagged_users:t.tagged_users}:Object.freeze({})};return(0,u.ZP)(e,a)?e:a},c=(e,t)=>{if(e=e||s,"FETCH_COMPLETE"===t.type){let{payload:{resource:a}}=t,{data:r}=t.payload.response.resource_response;if("AggregatedCommentFeedResource"===a||"AggregatedCommentReplyFeedResource"===a||"DidItCommentsResource"===a){let t=(r||[]).reduce((t,a)=>(t[a.id]=E(e[a.id],a),t),{});return{...e,...t}}if("UnifiedCommentsResource"===a&&r&&r.length>0){let t=r.filter(e=>"aggregatedcomment"===e.type).reduce((t,a)=>(t[a.id]=E(e[a.id],a),t),{});return{...e,...t}}if("UnifiedCommentsPreviewResource"===a&&r&&r.length>0){let t=r.map(e=>e.aggregated_comment).reduce((t,a)=>(a&&(t[a.id]=E(e[a.id],a)),t),{}),a=r.map(e=>e.creator_reply).reduce((t,a)=>(a&&a.id&&(t[a.id]=E(e[a.id],a)),t),{});return{...e,...t,...a}}if("AggregatedCommentFeaturesResource"===a&&r&&Object.keys(r).length>0)return{...e,feature_map:r}}else if("AGGREGATED_COMMENT_CREATED"===t.type){let{payload:{aggregatedComment:a}}=t;return a.id?{...e,[a.id]:a}:e}else if("AGGREGATED_COMMENT_DELETED"===t.type||"AGGREGATED_COMMENT_HIDDEN"===t.type){let{payload:{aggregatedCommentId:a}}=t,r={...e};return delete r[a],r}else if("AGGREGATED_COMMENT_HIDDEN_FOR_USER"===t.type){let{payload:{userId:a}}=t;return Object.fromEntries(Object.entries(e).filter(e=>e[1].user?.id!==a))}else if("AGGREGATED_COMMENT_UPDATED"===t.type){let{payload:{data:a}}=t;return{...e,[a.id]:E(e?.[a.id],a)}}else if("AGGREGATED_COMMENT_LIKE_TOGGLED"===t.type){let{payload:{data:a}}=t,r=e?.[a.id],n=r?.reaction_counts[1]||0,o={1:a.reaction_by_me?n+1:n-1},d={...r,reaction_by_me:a.reaction_by_me,reaction_counts:o};return{...e,[a.id]:d}}else if("AGGREGATED_COMMENT_HELPFUL_TOGGLED"===t.type){let{payload:{data:a}}=t,r=e?.[a.id],n=r?.helpful_count||0,o=a.marked_helpful_by_me?n+1:n-1,d={...r,marked_helpful_by_me:a.marked_helpful_by_me,helpful_count:o};return{...e,[a.id]:d}}else if("AGGREGATED_COMMENT_HIGHLIGHT_TOGGLED"===t.type){let{payload:{data:a}}=t,r={...e?.[a.aggregated_comment_id],highlighted_by_pin_owner:a.is_highlighted};return{...e,[a.aggregated_comment_id]:r}}else if("AGGREGATED_COMMENT_FEATURES_UPDATED"===t.type){let{payload:{data:{featureMap:a}}}=t;return{...e,feature_map:{...e?.feature_map,...a}}}else if("UPDATE_AGGREGATED_COMMENT_COMMENT_COUNT"===t.type){let{payload:{increment:a,id:r}}=t,n=e?.[r];if(!n)return e;let o={...n,comment_count:n.comment_count+a};return{...e,[r]:o}}else if("DELETE_COMMENT_MENTION"===t.type){let{payload:{aggregatedCommentId:a,tagged_users:r}}=t,n={...e?.[a],tagged_users:r};return{...e,[a]:n}}else if("GET_COMMENT_TRANSLATION"===t.type){let{payload:{aggregatedCommentId:a,translatedText:r}}=t,n={...e?.[a],translatedText:r};return{...e,[a]:n}}return e};var p=a(785893);let{Provider:T,get:y}=(0,g.Z)("AggregatedComments");function f({children:e}){let t=(0,n.v9)(({resources:e})=>e?.UnifiedCommentsResource),a=s;t&&Object.values(t).forEach(e=>{let t=e.data?.filter(e=>"aggregatedcomment"===e.type),r=t?.reduce((e,t)=>(e[t.id]=E(a[t.id],t),e),{});a={...a,...r}});let[o,d]=(0,r.useReducer)(c,a),l=e=>{d({type:"FETCH_COMPLETE",payload:e})};(0,_.Z8)("AggregatedCommentFeaturesResource",l),(0,_.my)("AggregatedCommentFeaturesResource",l),(0,_.Z8)("AggregatedCommentFeedResource",l),(0,_.my)("AggregatedCommentFeedResource",l),(0,_.Z8)("AggregatedCommentReplyFeedResource",l),(0,_.my)("AggregatedCommentReplyFeedResource",l),(0,_.Z8)("DidItCommentsResource",l),(0,_.my)("DidItCommentsResource",l),(0,_.Z8)("UnifiedCommentsPreviewResource",l),(0,_.my)("UnifiedCommentsPreviewResource",l),(0,_.Z8)("UnifiedCommentsResource",l),(0,_.my)("UnifiedCommentsResource",l);let g=(0,r.useMemo)(()=>({aggregatedComments:o,dispatch:d}),[o,d]);return(0,p.jsx)(T,{value:g,children:e})}function C(){let{dispatch:e}=y();return(0,r.useMemo)(()=>({aggregatedCommentCreated(t,a){e({type:"AGGREGATED_COMMENT_CREATED",payload:{parentId:t,aggregatedComment:a}})},aggregatedCommentDeleted:(t,a)=>{e({type:"AGGREGATED_COMMENT_DELETED",payload:{parentId:t,aggregatedCommentId:a}})},aggregatedCommentHidden:t=>{e({type:"AGGREGATED_COMMENT_HIDDEN",payload:{aggregatedCommentId:t}})},aggregatedCommentsHiddenForUser:t=>{e({type:"AGGREGATED_COMMENT_HIDDEN_FOR_USER",payload:{userId:t}})},flagAggregatedComment:async({isAggregatedComment:e=!0,commentId:t,reason:a,detailedReasons:r})=>{let n=e?`/v3/aggregated_comments/${t}/flag/`:`/v3/did_it/${t}/flag/`;return(0,i.Z)({url:n,method:"PUT",data:{commentId:t,reason:a,detailedReasons:r}})},deleteCommentMention:async t=>{let{resource_response:a}=await (0,i.Z)({url:`/v3/aggregated_comments/${t}/mentions/`,method:"DELETE",data:{fields:["aggregatedcomment.id","aggregatedcomment.tagged_users"]}}),r=a.data??{};e({type:"DELETE_COMMENT_MENTION",payload:{aggregatedCommentId:r.id,tagged_users:r.tagged_users}})},translateAggregatedComment:async t=>{try{let{resource_response:a}=await (0,i.Z)({url:`/v3/aggregated_comments/${t}/translate/`,method:"GET"}),r=a.data??"";e({type:"GET_COMMENT_TRANSLATION",payload:{aggregatedCommentId:t,translatedText:r}})}catch(a){e({type:"GET_COMMENT_TRANSLATION",payload:{aggregatedCommentId:t,translatedText:""}})}},toggleAggregatedCommentHelpful:({aggregatedCommentId:t,isMarkedHelpfulByMe:a,orbacSubjectId:r})=>{(0,i.Z)({url:`/v3/helpful/1/${t}/`,method:a?"DELETE":"POST",data:r?{orbac_subject_id:r}:{}}),e({type:"AGGREGATED_COMMENT_HELPFUL_TOGGLED",payload:{data:{id:t,marked_helpful_by_me:!a}}})},toggleAggregatedCommentHighlight:async({aggregatedCommentId:t,pinId:a,isHighlighted:r})=>{d()(t,"Could not find comment"),d()(a,"Could not find Pin"),await (0,i.Z)({url:"/v3/aggregated_comments/pin/highlight/",method:"PUT",data:{aggregated_comment:t,pin:a,highlight:!r}}),e({type:"AGGREGATED_COMMENT_HIGHLIGHT_TOGGLED",payload:{data:{aggregated_comment_id:t,pin_id:a,is_highlighted:!r}}})},toggleAggregatedCommentLike:({aggregatedCommentId:t,isLikedByMe:a,orbacSubjectId:r})=>{(0,i.Z)({url:`/v3/aggregated_comments/${t}/react/`,method:a?"DELETE":"POST",data:{reaction_type:1,...r?{orbac_subject_id:r}:{}}}),e({type:"AGGREGATED_COMMENT_LIKE_TOGGLED",payload:{data:{id:t,reaction_by_me:+!a}}})},updateAggregatedComment:async({commentId:t,force:a,orbacSubjectId:r,tags:n,text:o})=>{let{resource_response:d}=await l.Z.create("AggregatedCommentResource",{commentId:t,force:a,tags:n,text:o,...r?{orbacSubjectId:r}:{}}).callUpdate({showError:!1}),{tagged_users:g}=d.data??{};e({type:"AGGREGATED_COMMENT_UPDATED",payload:{data:{id:t,tagged_users:g.map(e=>({...e})),tags:JSON.parse(n),text:o}}})},updateAggregatedCommentFeatures:async({userId:t,featureMap:a,passcode:r,userConfirmPasscode:n})=>{let o={userId:t,featureMap:a,passcode:r,user_confirm_skip_passcode:n};void 0===n&&(o.user_confirm_skip_passcode=!1);let{resource_response:d}=await l.Z.create("AggregatedCommentFeaturesResource",o).callUpdate({showError:!1});e({type:"AGGREGATED_COMMENT_FEATURES_UPDATED",payload:{data:{featureMap:d.data??Object.freeze({})}}})},updateCommentCount:(t,a)=>{e({type:"UPDATE_AGGREGATED_COMMENT_COMMENT_COUNT",payload:{increment:a,id:t}})}}),[e])}function G(){let{aggregatedComments:e}=y();return e}},230543:function(e,t,a){a.d(t,{c:()=>n,t:()=>o});var r=a(598849);function n({children:e}){let{height:t}=(0,r.Z)();return e(t)}function o(){let{height:e}=(0,r.Z)();return e}},598849:function(e,t,a){a.d(t,{C:()=>r,Z:()=>o});let{Provider:r,get:n}=(0,a(729434).Z)("Header"),o=n},46731:function(e,t,a){a.d(t,{US:()=>p,X2:()=>y,mW:()=>T});var r=a(667294),n=a(575108),o=a(521009),d=a(729434),l=a(950883),g=a(791948),i=a(914071),_=a(785893);let u=()=>a.e("44343").then(a.bind(a,833234));function m(e,t,a=!1){return{type:"TOPIC_FOLLOW",payload:{id:e,value:t,showTooltip:a}}}function s(e){return n.Z.create("InterestFollowResource",{interest_id:e,interest_list:l.X})}let{Provider:E,get:c}=(0,d.Z)("Topics");function p({children:e}){let[t,a]=(0,i.Z)(u,{}),n=e=>{a({type:"TOPIC_FETCH_COMPLETE",payload:e})};(0,g.Z8)("InterestFollowingResource",n),(0,g.Z8)("InterestResource",n);let o=(0,r.useMemo)(()=>({dispatch:a,topics:t}),[a,t]);return(0,_.jsx)(E,{value:o,children:e})}function T(){let{dispatch:e}=c(),t=(0,o.Z)();return(0,r.useMemo)(()=>({follow:async(a,r=!1)=>{e(m(a,!0,r));try{await s(a).callCreate({showError:!1}),t({event_type:601,object_id_str:a})}catch(t){e(m(a,!1,r))}},unfollow:async a=>{e(m(a,!1));try{await s(a).callDelete({showError:!1}),t({event_type:602,object_id_str:a})}catch(t){e(m(a,!0))}}}),[e,t])}function y(){let{topics:e}=c();return e}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/23063-b3e8394308cf17fa.mjs.map