(self.modernJsonp=self.modernJsonp||[]).push([["34306"],{762587:function(e){e.exports=function(e,t,i,n){t=t||"&",i=i||"=";var a={};if("string"!=typeof e||0===e.length)return a;var l=/\+/g;e=e.split(t);var o=1e3;n&&"number"==typeof n.maxKeys&&(o=n.maxKeys);var s=e.length;o>0&&s>o&&(s=o);for(var r=0;r<s;++r){var d,c,u,m,_=e[r].replace(l,"%20"),g=_.indexOf(i);(g>=0?(d=_.substr(0,g),c=_.substr(g+1)):(d=_,c=""),u=decodeURIComponent(d),m=decodeURIComponent(c),Object.prototype.hasOwnProperty.call(a,u))?Array.isArray(a[u])?a[u].push(m):a[u]=[a[u],m]:a[u]=m}return a}},712361:function(e){var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,i,n,a){return(i=i||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e)?Object.keys(e).map(function(a){var l=encodeURIComponent(t(a))+n;return Array.isArray(e[a])?e[a].map(function(e){return l+encodeURIComponent(t(e))}).join(i):l+encodeURIComponent(t(e[a]))}).join(i):a?encodeURIComponent(t(a))+n+encodeURIComponent(t(e)):""}},817673:function(e,t,i){t.decode=t.parse=i(762587),t.encode=t.stringify=i(712361)},316387:function(e,t,i){var n,a;i.r(t),i.d(t,{default:()=>o});let l=(a=[n={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CommentThreadContainer_pin",selections:[{alias:null,args:null,concreteType:"AggregatedPinData",kind:"LinkedField",name:"aggregatedPinData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"commentCount",storageKey:null},{alias:null,args:null,concreteType:"AggregatedDidItData",kind:"LinkedField",name:"didItData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"imagesCount",storageKey:null}],storageKey:null},n],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"doneByMe",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"closeupAttribution",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"commentsDisabled",storageKey:null},n,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null});l.hash="6e4bec581cece19361386d6124ddde90";let o=l},441590:function(e,t,i){var n,a,l,o,s;i.r(t),i.d(t,{default:()=>d});let r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualContext_pin",selections:[{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"v720P",plural:!1,selections:o=[{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"duration",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captionsUrls",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV3MOBILE",plural:!1,selections:o,storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Embed",kind:"LinkedField",name:"embed",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subtype",storageKey:null}],storageKey:null},{alias:"imageSpec_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s=[l,n,a],storageKey:'images(spec:"564x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"736x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"orig")'},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"474x")'},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"236x")'},{alias:"imageSpec_1200x",args:[{kind:"Literal",name:"spec",value:"1200x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"1200x")'},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isVideo",storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetMainPinImage_pin"}],type:"Pin",abstractKey:null};r.hash="f5ddfd6a30ebe10b0f0a7b0bf12bea4e";let d=r},673588:function(e,t,i){var n;i.r(t),i.d(t,{default:()=>l});let a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useGetMainPinImage_pin",selections:[{alias:"imageSpec_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"564x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"736x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"orig")'},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"474x")'},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"236x")'},{alias:"imageSpec_1200x",args:[{kind:"Literal",name:"spec",value:"1200x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"1200x")'}],type:"Pin",abstractKey:null};a.hash="64a50a10a8f854ca82309453d98f41a7";let l=a},767439:function(e,t,i){i.d(t,{Z:()=>l});var n=i(667294);let a="undefined"!=typeof document?document:{},l=()=>{let e=(0,n.useRef)(void 0),t=a.documentElement,{body:i}=a;return t?[()=>{if(!i||!i.style||e.current)return;let n=window.innerWidth-t.clientWidth,a=parseInt(window.getComputedStyle(i).getPropertyValue("padding-right"),10)||0;t.style.position="relative",t.style.overflow="hidden",i.style.position="relative",i.style.overflow="hidden",i.style.paddingRight=`${a+n}px`,e.current=!0},()=>{i&&i.style&&e.current&&(t.style.position="",t.style.overflow="",i.style.position="",i.style.overflow="",i.style.paddingRight="",e.current=!1)}]:[]}},762802:function(e,t,i){i.d(t,{Z:()=>s});var n=i(667294),a=i(765533),l=i(603316);class o extends n.PureComponent{constructor(...e){var t,i,n;super(...e),t="handleKeyDown",i=e=>{let{onClose:t,goToNext:i,goToPrevious:n}=this.props,o=e.keyCode||e.code;!e.ctrlKey&&!e.metaKey&&(["input","select","button","textarea"].includes(((document.activeElement||{}).tagName||"").toLowerCase())||document.activeElement&&document.activeElement.isContentEditable||(o===a.Z.LEFT?(e.preventDefault(),e.stopPropagation(),n&&n(),(0,l.nP)("web_keydown_left")):o===a.Z.RIGHT?(e.preventDefault(),e.stopPropagation(),i&&i(),(0,l.nP)("web_keydown_right")):o===a.Z.ESCAPE&&(e.preventDefault(),e.stopPropagation(),t())))},(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in this?Object.defineProperty(this,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[t]=i}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}render(){return null}}let s=o},878709:function(e,t,i){i.d(t,{A:()=>g,G:()=>u});var n,a=i(667294);i(167912);var l=i(729434),o=i(415546),s=i(453179),r=i(607652),d=i(785893);let{Provider:c,get:u}=(0,l.Z)("VisualContext"),m=void 0!==n?n:n=i(441590),_=({children:e,pinKey:t,overrideValue:i={}})=>{let n=(0,o.Z)(m,t),{videos:l,embed:u,link:_,isVideo:g}=n??{},p=(0,a.useMemo)(()=>l?.videoList?.v720P?.url?{duration:l.videoList.v720P.duration||void 0,height:l.videoList.v720P.height||void 0,thumbnail:l.videoList.v720P.thumbnail||void 0,url:l.videoList.v720P.url||void 0,width:l.videoList.v720P.width||void 0,captions_urls:l.videoList.v720P.captionsUrls||void 0}:void 0,[l?.videoList?.v720P?.duration,l?.videoList?.v720P?.height,l?.videoList?.v720P?.thumbnail,l?.videoList?.v720P?.url,l?.videoList?.v720P?.width,l?.videoList?.v720P?.captionsUrls]),h=(0,a.useMemo)(()=>l?.videoList?.vHLSV4?.url?{duration:l.videoList.vHLSV4.duration||void 0,height:l.videoList.vHLSV4.height||void 0,thumbnail:l.videoList.vHLSV4.thumbnail||void 0,url:l.videoList.vHLSV4.url||void 0,width:l.videoList.vHLSV4.width||void 0}:void 0,[l?.videoList?.vHLSV4?.duration,l?.videoList?.vHLSV4?.height,l?.videoList?.vHLSV4?.thumbnail,l?.videoList?.vHLSV4?.url,l?.videoList?.vHLSV4?.width]),E=(0,a.useMemo)(()=>l?.videoList?.vHLSV3MOBILE?.url?{duration:l.videoList.vHLSV3MOBILE.duration||void 0,height:l.videoList.vHLSV3MOBILE.height||void 0,thumbnail:l.videoList.vHLSV3MOBILE.thumbnail||void 0,url:l.videoList.vHLSV3MOBILE.url||void 0,width:l.videoList.vHLSV3MOBILE.width||void 0}:void 0,[l?.videoList?.vHLSV3MOBILE?.duration,l?.videoList?.vHLSV3MOBILE?.height,l?.videoList?.vHLSV3MOBILE?.thumbnail,l?.videoList?.vHLSV3MOBILE?.url,l?.videoList?.vHLSV3MOBILE?.width]),y=(0,a.useMemo)(()=>{let e=p||h||E;return l?.entityId&&e?{id:l.entityId,hasVideo:e,mp4:p||void 0,hls:h||void 0,hlsv3:E||void 0}:null},[h,E,p,l?.entityId]),T=(0,s.sY)(u?.type),A=(0,s.oU)({isVideo:g,link:_}),{mainPinImage:I,srcSet:S,srcSizes:x}=(0,r.Z)({pinKey:n}),v=n?.imageSpec_1200x||n?.imageSpec_orig||n?.imageSpec_736x||n?.imageSpec_564x||n?.imageSpec_474x||n?.imageSpec_236x,C=(0,a.useMemo)(()=>({height:v?.height??1,url:v?.url??"",width:v?.width??1}),[v]),f=n?.imageSpec_236x,O=(0,a.useMemo)(()=>f?.url?{height:f.height??1,url:f.url,width:f.width??1}:null,[f]),P=(0,a.useMemo)(()=>{let e=u?.subtype==="pinstory",t=i.mainImage||I;return{...i,pinAspectRatioType:(0,s.Ct)(I?.width??2,I?.height??3),mainImage:t,previewImage:void 0===i.previewImage?O:i.previewImage,mediaViewerImage:C,video:y,embed:u,isYoutubePin:A,isEmbeddedVideo:!!u?.src&&!T&&!e,isGif:T,imgSrc:T&&u?.src?u.src:t.url,...T?{}:{srcSet:S},srcSizes:x}},[I,O,C,y,u,A,T,S,x,i]);return(0,d.jsx)(c,{value:P,children:e})},g=({children:e,pinKey:t,overrideValue:i={}})=>(0,d.jsx)(_,{overrideValue:i,pinKey:t,children:e})},406196:function(e,t,i){i.d(t,{E:()=>r,N:()=>d});var n=i(667294),a=i(655202),l=i(729434),o=i(785893);let{Provider:s,get:r}=(0,l.Z)("Flag"),d=({children:e})=>{let[t,i]=(0,n.useState)(),[l,r]=(0,n.useState)(a.Zw.REPORT),[d,c]=(0,n.useState)(a.qb.STARTED),[u,m]=(0,n.useState)(),[_,g]=(0,n.useState)(),p=(0,n.useMemo)(()=>({flagReason:_,flow:l,status:d,selectedReason:u,modalTitle:t,setFlagReason:g,setFlow:r,setModalTitle:i,setStatus:c,setSelectedReason:m}),[t,l,d,u,_]);return(0,o.jsx)(s,{value:p,children:e})}},655202:function(e,t,i){i.d(t,{Vm:()=>l,Zw:()=>n,qb:()=>a});let n={REPORT:"REPORT",BLOCK:"BLOCK",END:"END"},a={STARTED:"STARTED",SELECTED:"SELECTED",SUBMITTED:"SUBMITTED",PROCESSING:"PROCESSING",COMPLETED:"COMPLETED"},l={CONVERSATION:"CONVERSATION",DID_IT:"DID_IT"}},781011:function(e,t,i){i.d(t,{$N:()=>h,Cu:()=>y,GY:()=>m,MZ:()=>r,NR:()=>_,S9:()=>s,ar:()=>d,bC:()=>E,fm:()=>n,id:()=>l,kM:()=>o,q6:()=>a,qp:()=>u,uV:()=>g,ug:()=>p,xL:()=>c});let n={DOWNLOAD_TEMPLATE:"DOWNLOAD_TEMPLATE",UPLOAD_TEMPLATE:"UPLOAD_TEMPLATE",HISTORY:"HISTORY",BULK_ID_LIBRARY:"BULK_ID_LIBRARY",RESOURCES:"RESOURCES"},a={GENERAL:"GENERAL",CAMPAIGNS:"CAMPAIGNS",AD_GROUPS:"AD_GROUPS",ADS:"ADS",KEYWORDS:"KEYWORDS",PRODUCT_GROUPS:"PRODUCT_GROUPS",ERROR_CODES:"ERROR_CODES"},l={INTEREST:"INTEREST",DEVICE:"DEVICE",LANGUAGE:"LANGUAGE",LOCATION:"LOCATION",LOCATION_COUNTRY:"LOCATION_COUNTRY",LOCATION_METRO:"LOCATION_METRO",LOCATION_REGION:"LOCATION_REGION",AUDIENCE:"AUDIENCE",TARGETING_TEMPLATE:"TARGETING_TEMPLATE",CONVERSION_TAG:"CONVERSION_TAG"},o={BILLING_HISTORY:"BILLING_HISTORY",BILLING_FORMS:"BILLING_FORMS",ORDER_LINES:"ORDER_LINES",PROMOTIONS:"PROMOTIONS",TAX_DOCUMENTS:"TAX_DOCUMENTS",DOCUMENTS:"DOCUMENTS",PREPAID_CAMPAIGN_SPEND:"PREPAID_CAMPAIGN_SPEND_SUMMARY"},s={CREATE:"CREATE",MANAGE:"MANAGE",VIEW_REPORT:"VIEW_REPORT",AB_TEST_CREATE:"AB_TEST_CREATE"},r={GOOGLE_TAG_MANAGER:"Google Tag Manager",SHOPIFY:"Shopify",WOO_COMMERCE:"WooCommerce",WORDPRESS:"WordPress",SQUARESPACE:"Squarespace",WEEBLY:"Weebly",TEALIUM:"Tealium",MAGENTO:"Magento",ECWID:"Ecwid",BIG_COMMERCE:"BigCommerce",PREMMERCE:"Premmerce",SEGMENT:"Segment",BRANCH:"Branch",HIGHTOUCH:"Hightouch",EULERIAN:"Eulerian",ADOBE_CDP:"Adobe Real-Time CDP",ADOBE_COMMERCE:"Adobe Commerce",SALESFORCE_COMMERCE_CLOUD:"Salesforce Commerce Cloud",PINTEREST_CAPI_CONNECT:"Pinterest CAPI Connect"},d={GTM:r.GOOGLE_TAG_MANAGER,SHOPIFY:r.SHOPIFY,WORDPRESS:r.WORDPRESS,WOOCOMMERCE:r.WOO_COMMERCE,TEALIUM:r.TEALIUM},c={GTM:"GTM",SHOPIFY:"SHOPIFY",WORDPRESS:"WORDPRESS",WOOCOMMERCE:"WOOCOMMERCE",TEALIUM:"TEALIUM"},u={PINTEREST_TAG:"PINTEREST_TAG",PINTEREST_TAG_MANUAL_SETUP_FLOW:"PINTEREST_TAG_MANUAL_SETUP_FLOW",PINTEREST_TEST_EVENTS:"PINTEREST_TEST_EVENTS",PINTEREST_TAG_HEALTH:"PINTEREST_TAG_HEALTH",CONVERSION_HEALTH:"CONVERSION_HEALTH",CONVERSION_UPLOAD:"CONVERSION_UPLOAD",UPLOAD_HISTORY:"UPLOAD_HISTORY",PCA_UPLOAD_HISTORY:"PCA_UPLOAD_HISTORY",PCA_UPLOAD:"PCA_UPLOAD",CONVERSIONS_API:"CONVERSIONS_API",CONVERSIONS_API_ACCESS_TOKEN:"CONVERSIONS_API_ACCESS_TOKEN",CONVERSIONS_API_DEDUPLICATION:"CONVERSIONS_API_DEDUPLICATION",CONVERSIONS_API_PARTNER_SETUP_FLOW:"CONVERSIONS_API_PARTNER_SETUP_FLOW",CONVERSIONS_API_MANUAL_SETUP_FLOW:"CONVERSIONS_API_MANUAL_SETUP_FLOW",PINTEREST_EVENTS_OVERVIEW:"PINTEREST_EVENTS_OVERVIEW",CONVERSIONS:"CONVERSIONS",PINTEREST_EVENTS_OVERVIEW_BEFORE_SETUP:"PINTEREST_EVENTS_OVERVIEW_BEFORE_SETUP",PINTEREST_SETUP_API:"PINTEREST_SETUP_API",NOCODE_CONVERSIONS_API_SETUP_FLOW:"NOCODE_CONVERSIONS_API_SETUP_FLOW",PINTEREST_EVENTS_OVERVIEW_CAPI_TAB:"PINTEREST_EVENTS_OVERVIEW_CAPI_TAB",PINTEREST_EVENT_HISTORY_CAPI_TAB:"PINTEREST_EVENT_HISTORY_CAPI_TAB"},m={PINTEREST_TAG_DASHBOARD:"PINTEREST_TAG_DASHBOARD",PINTEREST_TAG_LANDING:"PINTEREST_TAG_LANDING",PINTEREST_TAG_INSTRUCTIONS:"PINTEREST_TAG_INSTRUCTIONS",CONVERSION_UPLOAD_LANDING:"CONVERSION_UPLOAD_LANDING",CONVERSION_UPLOAD_VALIDATION:"CONVERSION_UPLOAD_VALIDATION",CONVERSION_UPLOAD_HISTORY:"CONVERSION_UPLOAD_HISTORY",PCA_UPLOAD_HISTORY:"PCA_UPLOAD_HISTORY",PCA_UPLOAD_LANDING:"PCA_UPLOAD_LANDING",PCA_UPLOAD_VALIDATION:"PCA_UPLOAD_VALIDATION"},_={DESTINATION:"destination",EXPIRY:"expiry",SOURCE:"attributionsrc",SOURCE_EVENT_ID:"source_event_id",SOURCE_EVENT_TYPE:"source_event_type",PRIORITY:"priority",CLICK_PRIORITY:"2",VIEW_PRIORITY:"1",HOSTNAME:"hostname",CAMPAIGN_ID:"campaign_id",ADVERTISER_ID:"advertiser_id"},g="604800",p="86400",h={ATTRIBUTION_SOURCE_ID:"attributionsourceid",ATTRIBUTE_DESTINATION:"attributiondestination",ATTRIBUTE_ON:"attributeon"},E="click",y="view"},47944:function(e,t,i){i.d(t,{Z:()=>s});var n=i(20256),a=i(744862),l=i(525839),o=i(785893);let s=({isQuestion:e,name:t,size:i,src:s})=>{let r=(0,l.ZP)();return(0,o.jsxs)(n.xu,{"data-test-id":"comment-avatar-container",position:"relative",children:[(0,o.jsx)(a.qE,{name:t,size:i,src:s}),e&&(0,o.jsxs)(n.xu,{alignItems:"center",bottom:!0,display:"flex",height:16,justifyContent:"center",marginBottom:-1,marginEnd:-1,position:"absolute",right:!0,width:16,children:[(0,o.jsx)(n.xu,{position:"absolute",children:(0,o.jsx)(n.JO,{accessibilityLabel:r._('Q and A comment', 'comment.userAvatar.creator.q&aIndicator', 'question mark icon indicator background that comment is Q&A'),color:"dark",icon:"speech"})}),(0,o.jsx)(n.xu,{position:"absolute",children:(0,o.jsx)(n.JO,{accessibilityLabel:r._('Q and A comment', 'comment.userAvatar.creator.q&aIndicator', 'question mark icon indicator background that comment is Q&A'),color:"light",icon:"question-mark",size:8})})]})]})}},780734:function(e,t,i){i.d(t,{Z:()=>es});var n=i(20256),a=i(667294),l=i(581722),o=i(473727),s=i(767439),r=i(111923),d=i(406196),c=i(47944),u=i(525839),m=i(785893);let _=({color:e,isMarkedHelpful:t})=>{let i=(0,u.ZP)();return(0,m.jsx)(n.JO,{accessibilityLabel:i._('Helpful', 'comment.button.helpful', 'mark or unmark comment as helpful'),color:t?"brandPrimary":e,icon:"thumbs-up",inline:!0,size:12})};var g=i(296691),p=i(333651),h=i(773655),E=i(744862);let y={helpfulStyle:{backgroundImage:`url(${p})`},lovedStyle:{backgroundImage:`url(${h})`}},T=({response:e,handleReactionListHover:t,maybeDismissReactionListWithDelay:i})=>{let a=14===e.reaction_type,l=1===e.reaction_type,o=e.user.is_private_profile?e.user.first_name:e.user.full_name;return(0,m.jsxs)(n.kC,{alignItems:"center",children:[(0,m.jsx)(n.Tg,{href:`/${e.user.username}/`,onBlur:i,onFocus:t,children:(0,m.jsxs)(n.kC,{alignItems:"center",children:[(0,m.jsx)(n.xu,{maxWidth:40,children:(0,m.jsx)(E.qE,{accessibilityLabel:"",name:o,outline:!0,size:"sm",src:e.user.image_medium_url})}),(0,m.jsx)(n.xu,{marginStart:2,maxWidth:80,children:(0,m.jsx)(n.xv,{color:"inverse",size:"100",weight:"bold",children:o})})]})}),(0,m.jsxs)(n.xu,{alignContent:"end",display:"flex",padding:2,children:[l&&(0,m.jsx)(n.xu,{dangerouslySetInlineStyle:{__style:y.lovedStyle},"data-test-id":"comment-reaction-tray-loved-emoji",height:16,width:16}),a&&(0,m.jsx)(n.xu,{dangerouslySetInlineStyle:{__style:y.helpfulStyle},"data-test-id":"comment-reaction-tray-helpful-emoji",height:16,width:16})]})]})};var A=i(821342),I=i(886981),S=i(448505),x=i(7872);let v=["userreaction.id","userreaction.reaction_type","userreaction.user()","user.first_name","user.full_name","user.id","user.image_medium_url","user.is_private_profile","user.username"],C=({commentId:e,handleReactionListHover:t,isMarkedHelpfulByMe:i,isLovedByMe:l,isTry:o,maybeDismissReactionListWithDelay:s})=>{let r=(0,A.Z)(),d=(0,S.Z)(),c=(0,I.Z)({name:"ApiResource",options:{url:o?`/v3/did_it/${e}/reacted_by/`:`/v3/aggregated_comments/${e}/reacted_by/`,field_sets:v}}),u=(0,x.lJ)(r,d)||("id"in r&&r.id?r.id:""),_=c.data;(l||i)&&_&&(_=_.filter(e=>e.user.id!==u),_=[{id:e,reaction_type:l?1:14,user:{first_name:(0,x.Fk)(r,d),full_name:(0,x.Fk)(r,d),id:u,image_medium_url:(0,x.gJ)(r,d),is_private_profile:!!r.isAuth&&!!r.isPrivateProfile,username:(0,x.Ms)(r,d)}},..._]);let g=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let{current:e}=g,t=()=>{c.isFetching||(c.isAtEnd?e?.removeEventListener("scroll",t):c.fetchMore())};return e?.addEventListener("scroll",t),()=>{e?.removeEventListener("scroll",t)}},[c]),(0,m.jsx)(n.xu,{ref:g,color:"selected",maxHeight:140,overflow:"scroll",rounding:2,width:180,children:_?.map(e=>(0,m.jsx)(n.xu,{"data-test-id":"reaction-list-single-user",margin:3,children:(0,m.jsx)(T,{handleReactionListHover:t,maybeDismissReactionListWithDelay:s,response:e})},e.id))})};var f=i(821806),O=i(601686);let P=(0,a.lazy)(()=>i.e("46308").then(i.bind(i,766289))),R="comment-reaction-container-entry-point",L=({commentId:e,dismissReactionList:t,helpfulCount:i,inCommentRepRedesignExp:l,isMarkedHelpfulByMe:o,isLovedByMe:s,isReactionListOpen:r,isTry:d,lovedCount:c,onReactionCountHover:_,onToggleHelpful:E,onToggleLove:y})=>{let T=(0,u.ZP)(),{isCommentComposerFocused:A}=(0,O.x4)(),I=(0,a.useRef)(null),S=l?12:16,[x,v]=(0,a.useState)(!1),L=!1,b=(c||0)+(i||0);o&&s&&(b-=1);let N=e=>()=>{v(e)},D=()=>{L=!0,_()},w=()=>{L=!1,setTimeout(()=>{L||t()},1e3)},M=l?(0,m.jsx)(n.xu,{"data-test-id":R,margin:-1.5,children:(0,m.jsx)(n.hU,{accessibilityLabel:T._('React', 'comment.actionbar.react', 'accessibility label entry point to react to a comment'),icon:"heart-outline",onClick:y(!0),size:"xs"})}):(0,m.jsx)(n.xu,{"data-test-id":R,children:x?(0,m.jsx)(n.iP,{onMouseLeave:N(!1),onTap:N(!1),children:(0,m.jsx)(f.Z,{children:(0,m.jsx)(P,{onTooltipHover:N(!1),setHelpful:E(!0),setLoved:y(!0)})})}):(0,m.jsx)(n.iP,{onMouseEnter:N(!0),onTap:N(!0),children:(0,m.jsx)(n.JO,{accessibilityLabel:T._('React', 'comment.actionbar.react', 'accessibility label entry point to react to a comment'),color:"subtle",icon:"heart-outline",size:S})})});return(0,m.jsxs)(n.kC,{alignItems:"center",gap:{row:l?1.5:1,column:0},children:[o||s?(0,m.jsx)(n.iP,{onTap:()=>{E(!1)(),y(!1)()},children:(0,m.jsx)(n.xu,{dangerouslySetInlineStyle:{__style:{backgroundImage:`url(${s?h:p})`,backgroundSize:"contain"}},"data-test-id":s?"comment-reaction-container-loved-emoji":"comment-reaction-container-helpful-emoji",height:S,width:S})}):M,b>0&&(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(n.iP,{onMouseEnter:D,onMouseLeave:w,onTap:D,children:(0,m.jsx)(n.xu,{ref:I,"data-test-id":"comment-reaction-container-reaction-count",display:l?"flex":void 0,children:(0,m.jsx)(n.xv,{color:l?"default":"subtle",inline:!0,size:l?"100":"200",weight:"bold",children:b})})}),r&&(0,m.jsx)(n.mh,{zIndex:g.Ty,children:(0,m.jsx)(n.J2,{anchor:I.current,idealDirection:"down",onDismiss:t,positionRelativeToAnchor:!1,shouldFocus:!A,children:(0,m.jsx)(n.iP,{onMouseEnter:D,onMouseLeave:w,children:(0,m.jsx)(C,{commentId:e,handleReactionListHover:D,isLovedByMe:s,isMarkedHelpfulByMe:o,isTry:d,maybeDismissReactionListWithDelay:w})})})})]})]})};var b=i(624895),N=i(54424),D=i(545961),w=i(162321);function M(e){let{comment:t,commentTags:i,handlePhotoTap:l,inCommentRepRedesignExp:o,isDesktop:s,previewPhoto:r,taggedUsers:d}=e,[c,u]=(0,a.useState)(!1),{user:{username:_}}=t,g="text"in t?t.text:t.details,p=o?g:`${_} ${g}`,{height:h,url:E,width:y}=r||{},T=h??D.Vb,A=y??D.mu;return(0,m.jsxs)(n.xu,{children:[(0,m.jsx)(w.Z,{isFirstTaggedUserAuthor:!0,shouldShowFirstNameOnly:!0,taggedUsers:d,tags:i,text:p}),s||o?(0,m.jsx)(n.xu,{marginBottom:o?1.5:void 0,marginTop:o?.5:1,children:(0,m.jsx)(D.ZP,{canEnlargePhoto:s,isSelectedPhoto:!1,previewPhoto:r})}):(0,m.jsx)(n.xu,{height:150,marginBottom:s?4:2,marginTop:1,width:150,children:(0,m.jsx)(n.iP,{disabled:!s,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),onTap:l,children:(0,m.jsx)(n.zd,{rounding:2,wash:!0,children:E&&(0,m.jsx)(n.Ee,{alt:E,color:"#efefef",naturalHeight:T,naturalWidth:A,src:E,children:(0,m.jsx)(n.xu,{dangerouslySetInlineStyle:{__style:{cursor:s?"zoom-in":void 0,backgroundColor:`rgba(17, 17, 17, ${.4*!!c})`}},height:"100%",width:"100%"})},E)})})})]})}var j=i(667835),k=i(302148),G=i(105433),U=i(696323);function H(e){let{featuredCommentId:t,parentId:i,parentType:o,inCommentRepRedesignExp:s,inCommentsImprovedDropdownExp:r,inCommentsPopover:d,isDesktop:c,isLoading:_,isReadOnly:g,openOverflowMenu:p,replyingToCommentId:h,toggleEditComposer:E,toggleHelpful:y,toggleLike:T,toggleReplyComposer:A,isORBACProfileManager:I,isVideo:S,storyPinDataId:x,pinId:v,closeupAttributionId:C,aggregatedPinDataId:f,closeupAttributionUsername:O,pinnerId:P,reactionListCommentId:R,showReactionListForComment:L,viewParameter:b}=e,N=(0,u.ZP)(),D=(0,j.vs)(),w=(0,G.lV)(),M=(0,l.v9)(({feeds:e})=>{let t=e[`${U.Z.AGGREGATED_COMMENT_REPLIES}:${i}`]||[],n=e[`${U.Z.AGGREGATED_COMMENTS}:${i}`]||[];return t.concat(n).reduceRight((e,{id:t})=>{let i=w[t];return i?[...e,i]:e},[])}),H=(0,a.useRef)(!0),F=(0,a.useRef)(M.length),[z,V]=(0,a.useState)(1),[Z,B]=(0,a.useState)(!1),K=z===M.length;return(0,a.useEffect)(()=>{let e=F.current,t=M.length;H.current?t>0&&(H.current=!1):t>e&&B(!0),t!==e&&V(e=>e>1?t:+(t>0)),F.current=t},[M.length]),(0,m.jsxs)(a.Fragment,{children:[M.length>1&&(0,m.jsx)(n.iP,{onTap:()=>{V(K?0:M.length)},children:(0,m.jsxs)(n.xu,{alignItems:s?"center":void 0,display:s?"flex":void 0,marginBottom:s?6:4,children:[s?(0,m.jsx)(n.xu,{dangerouslySetInlineStyle:{__style:{background:D?"white":"black"}},height:1,marginEnd:2,width:32}):(0,m.jsx)(n.xu,{display:"inlineBlock",marginEnd:2,children:(0,m.jsx)(n.xv,{color:"subtle",size:"200",weight:"bold",children:"⎯⎯"})}),(0,m.jsx)(n.xv,{color:s?"default":"subtle",inline:!0,size:"100",weight:"bold",children:K?N._('Hide replies', 'comment.button.hideReplies', 'hide comment replies'):(0,k.nk)(N.ngettext('View {{ commentCount }} reply', 'View {{ commentCount }} replies', M.length, 'comment.button.showReplies', 'show comment replies'),{commentCount:M.length})})]})}),(0,m.jsx)(es,{aggregatedPinDataId:f,closeupAttributionId:C,closeupAttributionUsername:O,comments:(()=>{if(0===z||0===M.length)return[];if(1===z)if(Z)return M.slice(-1);else return M.slice(0,1);return M.slice(0,z)})(),commentsDisabled:!1,featuredCommentId:t,gapSize:s?6:2,inCommentRepRedesignExp:s,inCommentsImprovedDropdownExp:r,inCommentsPopover:d,isDesktop:c,isLoading:_,isORBACProfileManager:I,isReadOnly:g,isVideo:S,openOverflowMenu:p,parentId:i,parentType:o,pinId:v,pinnerId:P,reactionListCommentId:R,replyingToCommentId:h,showReactionListForComment:L,storyPinDataId:x,toggleEditComposer:E,toggleHelpful:y,toggleLike:T,toggleReplyComposer:A,userAvatarSize:"sm",viewParameter:b})]})}var F=i(980787),z=i(657043),V=i(475498),Z=i(670622),B=i(2420),K=i(15667),W=i(536652),$=i(87853),Y=i(542092),q=i(636921),Q=i(502066),J=i(483190),X=i(611134),ee=i(401450),et=i(78762);let ei=(0,a.lazy)(()=>i.e("16592").then(i.bind(i,357966))),en=(0,et.Z)(()=>i.e("73842").then(i.bind(i,434780)),void 0,e=>434780,"app-packages-comment-CommentOverflowPopover"),ea=(0,a.lazy)(()=>i.e("84046").then(i.bind(i,257233)));function el(e){let t,i,{aggregatedPinDataId:p,closeupAttributionId:h,closeupAttributionUsername:E,comment:y,featuredCommentId:T,inCommentRepRedesignExp:I,inCommentsImprovedDropdownExp:v,inCommentsPopover:C,isDesktop:P,isReadOnly:R,isVideo:D,openOverflowMenu:U,toggleReplyComposer:et,parentId:el,parentType:eo=Y.o.pin,pinId:es,storyPinDataId:er,replyingToCommentId:ed,showReactionListForComment:ec,showTopCommentHeading:eu,toggleEditComposer:em,toggleHelpful:e_,toggleLike:eg,userAvatarSize:ep,isORBACProfileManager:eh,pinnerId:eE,reactionListCommentId:ey,viewParameter:eT}=e,{user:{id:eA,first_name:eI,id:eS,image_medium_url:ex,username:ev},id:eC,is_translatable:ef,comment_count:eO,helpful_count:eP,tags:eR=[]}=y,[eL,eb]=(0,a.useState)(!1),eN=eL&&y.translatedText||y.text,eD=!ef||""===y.translatedText,ew=(0,q.Z)(),eM=!1,ej=0,ek=!1,eG=!!y.marked_helpful_by_me,eU=I?[]:[y.user],eH="",eF=new Date;"aggregatedcomment"===y.type?(eM=y.highlighted_by_pin_owner,ej=y.reaction_counts[1],ek=y.reaction_by_me>0,i=y?.media?.sticker,eU.push(...y.tagged_users),eH=I?eN??"":`${ev} ${eN??""}`,eF=new Date(y.created_at)):(ej=y.like_count,ek=y.liked_by_me,t=y.images[0]||{},eH=I?y.details:`${ev} ${y.details}`,eF=new Date(y.done_at));let ez=t?.["150x150"],eV=t?.originals,eZ=i||eV,eB=(0,u.ZP)(),eK=(0,A.Z)(),{setIsMediaViewerOpen:eW,clientTrackingParams:e$,setIsCommentPopoverInteractionActive:eY}=(0,O.x4)(),{logContextEvent:eq}=(0,F.u)(),{isBot:eQ}=(0,K.B)(),{showToast:eJ}=(0,$.dI)(),eX=(0,l.I0)(),e0=(0,j.vs)(),e1=(0,a.useRef)(null),{hasApplicableLawForCountry:e6}=(0,J.ZP)(),e2=!R||e6,e4="aggregatedcomment"===y.type&&1===y.comment_tag,e3=e4&&!I,e7=(0,S.Z)(),e5=(0,x.lJ)(eK,e7),{nativeEngagementsHiddenForUser:e9}=(0,Q.G)(),{aggregatedCommentsHiddenForUser:e8,translateAggregatedComment:te,updateAggregatedComment:tt}=(0,G.nf)(),ti=(0,r.Z)(),tn="userdiditdata"===y.type,ta=(0,Z.Z)(),tl=ef&&!1,to=P||I?eV:ez,ts=(0,g.zs)(ev,eR,e0,I),tr={SHOW_TRANSLATION:eB._('Show translation', 'comment.translateButton.showTranslation', 'text for translation button when translation is available'),TRANSLATING:eB._('Translating...', 'comment.translateButton.translating', 'text for translation button while translating'),SHOW_ORIGINAL:eB._('Show original', 'comment.translateButton.showOriginal', 'text for translation button after translating')},td=(0,a.useRef)(tr.SHOW_TRANSLATION),[tc,tu]=(0,s.Z)(),[tm,t_]=(0,a.useState)(!1),[tg,tp]=(0,a.useState)(!1),[th,tE]=(0,a.useState)(!1),[ty,tT]=(0,a.useState)(!1),[tA,tI]=(0,a.useState)(!1),[tS,tx]=(0,a.useState)(!1),[tv,tC]=(0,a.useState)(!1),[tf,tO]=(0,a.useState)(g.A9.NONE),tP=e=>()=>{em?em(y):tp(e)};(0,a.useEffect)(()=>{tl&&eq({event_type:10416,view_type:3,view_parameter:eT,component:"pin"===eo?13696:13697})},[eq,eo,tl,eT]),(0,a.useEffect)(()=>{eO>0&&!eQ&&eX((0,W.U)("aggregatedcomment"===y.type?"AggregatedCommentReplyFeedResource":"DidItCommentsResource",{options:{isUnifiedComment:!0,objectId:eC,redux_normalize_feed:!0}}))},[y.type,eC]);let tR=eo.toLowerCase()===Y.o.aggregatedComment.toLowerCase()||eo.toLowerCase()===Y.n.didIt.toLowerCase(),tL=y.user.first_name||"",tb=async({contentMarkdown:e,force:t,tags:i})=>{let n,a;tT(!0);let l=y.id;if(tR&&(n=eo.toLowerCase()===Y.n.didIt,l=el,a=y.id),l)try{await ti({force:t,fromUnifiedComment:!0,objectType:tn||n?Y.o.didIt:Y.o.aggregatedComment,objectId:l,orbacSubjectId:e5,tags:i,text:e,replyToCommentId:a})}catch(t){let e=(0,z.Z)(t,"code");if([B.ky,B.LJ].includes(e??0)&&P)return tO(e===B.ky?g.A9.WARNING:g.A9.BLOCK),tT(!1),!1}return et&&et(void 0),tT(!1),!0},tN=async({contentMarkdown:e,force:t,tags:i})=>{tE(!0);try{tn?await eX((0,X.IU)({id:y.id,details:e,pinId:es??"",image_signatures:"image_signatures"in y&&y.image_signatures?y.image_signatures:[]})):await tt({commentId:y.id,force:t,orbacSubjectId:e5,tags:i,text:e})}catch(e){if([B.ky,B.LJ].includes((0,z.Z)(e,"code")??0)&&P)return tO(e.code===B.ky?g.A9.WARNING:g.A9.BLOCK),tE(!1),!1}return tp(!1),tE(!1),!0},tD=()=>{P?(eY(!tm),t_(!tm)):U&&U(y)},tw=e=>()=>{eY(e),t_(e),tC(e),e||eq({component:14349,event_type:9408})},tM=()=>{tO(g.A9.NONE)},tj=e=>{e?tu():tc(),eW(!e),tI(!e)};(0,a.useEffect)(()=>{eL&&eD&&(eb(!eL),eJ(({hideToast:e})=>(0,m.jsx)(V.Z,{onHide:e,text:eB._('Error - couldn\'t translate', 'comment.couldNotTranslate.toast', 'error toast that shows after unsuccessful translation'),type:"error"})))},[eL,eD]),eL?td.current=y.translatedText?tr.SHOW_ORIGINAL:tr.TRANSLATING:td.current=tr.SHOW_TRANSLATION;let tk=P?128:110,tG="aggregatedcomment"===y.type&&y.media?.sticker?.image_url&&(0,m.jsx)(n.xu,{height:tk,marginBottom:+!!P,marginTop:1,width:tk,children:y.media?.sticker?.image_url&&(0,m.jsx)(n.Ee,{alt:y.media?.sticker?.display_name??"",fit:"contain",naturalHeight:0,naturalWidth:0,src:y.media.sticker.image_url})});return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(n.xH,{accessibilityLabel:"Loading comment",show:th}),!tg&&!th&&(0,m.jsxs)(n.kC,{alignItems:"stretch",justifyContent:"start",children:[(0,m.jsx)(n.xu,{marginEnd:2,children:(0,m.jsx)(o.rU,{to:`/${ev}/`,children:(0,m.jsx)(c.Z,{isQuestion:e3,name:eI||ev||"",size:ep,src:ex??""})})}),(0,m.jsxs)(n.kC,{direction:"column",flex:"grow",justifyContent:"start",children:[(0,m.jsxs)(n.kC,{justifyContent:"between",children:[(0,m.jsx)(n.kC.Item,{minWidth:0,children:(0,m.jsxs)(n.kC,{dataTestId:"author-and-comment-container",direction:"column",children:[I&&(0,m.jsxs)(n.kC,{alignItems:"center",gap:{row:1,column:0},children:[(0,m.jsx)(w.Z,{isFirstTaggedUserAuthor:!0,lineHeight:"14px",marginEnd:0,shouldShowFirstNameOnly:!0,size:"100",taggedUsers:[y.user],tags:(0,g.zs)(ev,[],e0),text:ev}),e4&&!eu&&(0,m.jsx)(n.xu,{dangerouslySetInlineStyle:{__style:{lineHeight:"14px"}},children:(0,m.jsx)(n.xv,{color:"subtle",size:"100",children:eB._('asked a question \uD83D\uDC40', 'comment.question.label', 'label on a comment that is a question')})}),eu&&(0,m.jsxs)(n.kC,{children:[(0,m.jsx)(n.xu,{alignItems:"center",display:"flex",marginEnd:1,children:(0,m.jsx)(n.JO,{accessibilityLabel:(0,g.yW)(eB),color:"recommendation",icon:"star",size:12})}),(0,m.jsx)(n.xv,{color:"recommendation",size:"100",weight:"bold",children:(0,g._q)(eB)})]}),(e4||eu)&&eF&&(0,m.jsx)(n.xv,{color:"subtle",size:"100",children:"·"}),eF&&(0,m.jsx)(n.xu,{"data-test-id":"comments-time-passed",children:(0,m.jsx)(n.xv,{color:"subtle",size:"100",children:ta(eF,!0)})})]}),tn?(0,m.jsx)(M,{comment:y,commentTags:ts,handlePhotoTap:()=>tj(tA),inCommentRepRedesignExp:I,isDesktop:P,previewPhoto:to,taggedUsers:eU}):(0,m.jsx)(w.Z,{isFirstTaggedUserAuthor:!I,lineHeight:I?"21px":void 0,marginBottom:I?"4px":void 0,shouldShowFirstNameOnly:!0,taggedUsers:eU,tags:ts,text:eH}),tG,tl&&(0,m.jsx)(n.xu,{marginBottom:2,marginTop:2,children:(0,m.jsx)(n.iP,{onTap:()=>void(!eL&&!y.translatedText&&te(y.id),eL||td.current!==tr.SHOW_TRANSLATION?eL&&td.current===tr.SHOW_ORIGINAL&&eq({event_type:10418,view_type:3,view_parameter:eT,component:"pin"===eo?13696:13697}):eq({event_type:10417,view_type:3,view_parameter:eT,component:"pin"===eo?13696:13697}),eb(!eL)),children:(0,m.jsx)(n.xv,{color:"subtle",size:"300",weight:"bold",children:td.current})})})]})}),T===eC&&(0,m.jsx)(n.xu,{alignSelf:"center",color:"primary",height:8,minWidth:8,rounding:"pill"})]}),eM&&(0,m.jsx)(n.xu,{marginBottom:I?1.5:3,marginTop:I?-.5:4,children:(0,m.jsx)(n.xv,{size:"100",children:(0,k.nk)(eB._('Highlighted by @{{ closeupAttributionUsername }}', 'comment.highlighted.label', 'label on comment that has been highlighted by the Pin creator'),{closeupAttributionUsername:E})})}),e2&&(0,m.jsxs)(n.xu,{alignItems:"center",display:"flex",height:P?25:"100%",justifyContent:"between",position:"relative",children:[(0,m.jsxs)(n.kC,{alignItems:"center",gap:{row:I?4:5,column:0},children:[!R&&!I&&(0,m.jsx)(n.xu,{"data-test-id":"comments-time-passed",children:(0,m.jsx)(n.xv,{color:"subtle",size:"200",children:ta(eF,!0)})}),!R&&(0,m.jsx)(n.xu,{"data-test-id":"comment-reply-button-container",children:(0,m.jsx)(n.iP,{onTap:()=>{et&&et(y,el,eo)},children:(0,m.jsx)(n.xv,{color:I?"default":"subtle",size:I?"100":"200",weight:"bold",children:eB._('Reply', 'comment.button.reply', 'entry point to reply to comment')})})}),!R&&(P||I?(0,m.jsx)(L,{commentId:eC,dismissReactionList:()=>{ec(void 0)},helpfulCount:eP,inCommentRepRedesignExp:I,isLovedByMe:ek,isMarkedHelpfulByMe:eG,isReactionListOpen:ey===eC,isTry:tn,lovedCount:ej,onReactionCountHover:()=>{ec(eC),eq({event_type:9906,component:"pin"===eo?13696:13697,view_type:3,view_parameter:eT})},onToggleHelpful:e=>()=>{eG!==e&&e_(eC,!e,tn)()},onToggleLove:e=>()=>{ek!==e&&eg(eC,!e,tn)()}}):(0,m.jsxs)(n.xu,{alignItems:"center","data-test-id":"reactions-likeWithCountButton",display:"flex",children:[(0,m.jsx)(n.hU,{accessibilityLabel:eB._('Like', 'comment.button.like', 'like or unlike comment'),icon:"heart",iconColor:ek?"red":"gray",onClick:eg(eC,ek,tn),size:"xs"}),ej>0&&(0,m.jsx)(n.xu,{"data-test-id":"love-count-container",children:(0,m.jsx)(n.xv,{color:"subtle",size:"100",weight:"bold",children:ej})})]})),!("id"in eK&&eK.id===eS&&e4)&&(I?(0,m.jsx)(n.iP,{onTap:tD,children:(0,m.jsx)(n.JO,{accessibilityLabel:eB._('More', 'comment.button.more', 'see more options for comment'),color:e0?"light":"dark",icon:"ellipsis",size:12})}):(0,m.jsx)(n.xu,{ref:e1,"data-test-id":"comment-more-options",children:(0,m.jsx)(n.hU,{accessibilityLabel:eB._('More', 'comment.button.more', 'see more options for comment'),icon:"ellipsis",iconColor:"gray",onClick:tD,size:"xs"})}))]}),!R&&!eh&&!P&&!I&&(0,m.jsx)(n.xu,{marginStart:6,children:(0,m.jsx)(n.iP,{fullWidth:!1,onTap:e_(eC,eG,tn),children:(0,m.jsxs)(n.kC,{alignItems:"center",dataTestId:"helpful-reaction",gap:{row:1,column:0},height:"100%",children:[(0,m.jsx)(_,{color:"subtle",isMarkedHelpful:eG}),(0,m.jsx)(n.xv,{color:"subtle",size:"200",weight:"bold",children:eB._('Helpful', 'comment.button.helpful', 'mark or unmark comment as helpful')}),eP>0&&(0,m.jsx)(n.xu,{"data-test-id":"helpful-count-container",children:(0,m.jsx)(n.xv,{color:"subtle",size:"100",weight:"bold",children:eP})})]})})})]})]})]}),P&&(0,m.jsxs)(a.Fragment,{children:[tg&&!(C||v)&&(0,m.jsx)(n.xu,{marginTop:3,children:(0,m.jsx)(b.Z,{clientTrackingParams:e$,commentWarningModalState:tf,dismissCommentWarningModal:tM,initialTags:y.tags,initialText:"aggregatedcomment"===y.type?y.text:y.details,isEditing:!0,objectType:Y.o.aggregatedComment,onAddItem:tN,onCancelItem:tP(!1),postedPhoto:eZ,showCommentComposer:!0,statusType:"textInFlightNested",viewParameter:eT})}),ed===eC&&(0,m.jsx)(n.xu,{marginStart:12*!tR,marginTop:3,children:(0,m.jsx)(b.Z,{commentWarningModalState:tf,dismissCommentWarningModal:tM,initialTags:tR?[{offset:0,object_id:eA,length:tL.length,tag_type:1}]:[],initialText:tR?`${tL} `:"",isReplying:!0,objectType:Y.o.aggregatedComment,onAddItem:tb,onCancelItem:()=>{et&&et()},showCommentComposer:!0,statusType:"textInFlightNested",viewParameter:eT})})]}),(eO>0||ty)&&(0,m.jsx)(n.xu,{marginStart:I?10:12,marginTop:I?3:4,children:(0,m.jsx)(H,{aggregatedPinDataId:p,closeupAttributionId:h,closeupAttributionUsername:E,featuredCommentId:T,inCommentRepRedesignExp:I,inCommentsImprovedDropdownExp:v,inCommentsPopover:C,isDesktop:P,isLoading:ty,isORBACProfileManager:eh,isReadOnly:R,isVideo:D,openOverflowMenu:U,parentId:eC,parentType:y.type,pinId:es,pinnerId:eE,reactionListCommentId:ey,replyingToCommentId:ed,showReactionListForComment:ec,storyPinDataId:er,toggleEditComposer:em,toggleHelpful:e_,toggleLike:eg,toggleReplyComposer:et,viewParameter:eT})}),P&&e2&&(0,m.jsx)(en,{aggregatedPinDataId:p,anchor:e1.current,closeupAttributionId:h,comment:y,dismiss:e=>{t_(!1),e||(eY(!1),eq({component:14349,event_type:10128}))},inCommentsPopover:!!C,isOpen:tm,isReply:tR,onEdit:tP(!0),onShowBlockUserModal:tw(!0),parentId:el,pinId:es,pinnerId:eE}),tS&&(0,m.jsx)(f.Z,{children:(0,m.jsx)(d.N,{children:(0,m.jsx)(ea,{aggregatedPinDataId:p,didItDataId:eC,onClose:e=>()=>{tx(!e)},pinId:es??"",username:ev,users:[y.user]})})}),tv&&(0,m.jsx)(f.Z,{children:(0,m.jsx)(ei,{firstName:eI??"",onBlockUser:()=>{eX((0,ee.Ge)({id:eA,orbacSubjectId:e5,blockSource:"comment",blockContext:eC,logContextEvent:eq})),e8(eA),e9(eA),eq({event_type:101,component:13712,element:87,view_type:220,aux_data:{creator_id:eK.isAuth?eK.id:null}}),eq({component:14349,event_type:9407}),tC(!1),ew(),eY(!1)},onClearModal:tw(!1)})}),!!eV&&tA&&(0,m.jsx)(N.Z,{onDismiss:()=>tj(tA),photo:eV})]})}var eo=i(351607);function es(e){let t,i,{aggregatedPinDataId:a,comments:l,commentsDisabled:o,commentsScrollContainerRef:s,featuredCommentId:r,gapSize:d=6,inCommentsImprovedDropdownExp:c,inCommentsPopover:_,inCommentRepRedesignExp:g,isDesktop:p,isLoading:h=!1,isReadOnly:E,openOverflowMenu:y,toggleReplyComposer:T,parentId:A,parentType:I,replyingToCommentId:S,showingCloseupCommentModule:x,toggleEditComposer:v,toggleHelpful:C,toggleLike:f,userAvatarSize:P,isORBACProfileManager:R,isVideo:L,storyPinDataId:b,pinId:N,closeupAttributionId:D,closeupAttributionUsername:w,pinnerId:M,showReactionListForComment:j,reactionListCommentId:k,viewParameter:G}=e,U=(0,u.ZP)(),{closeupWithinMasonryEnabled:H}=(0,O.x4)(),F=!!x&&!1;return(_?t="12px":H&&(t="8px"),i=b?"story":L?"video":"pin",o)?(0,m.jsx)(n.xu,{alignSelf:"center","data-test-id":"comments-disabled-label",marginTop:H?2:void 0,width:"100%",children:(0,m.jsx)(n.xv,{align:p?"start":"center",color:"subtle",children:U._('Comments are turned off for this Pin', 'commentThread.disabledState.message', 'Comments are turned off or disabled for this pin')})}):l.length>0?(0,m.jsxs)(n.xu,{ref:s,dangerouslySetInlineStyle:{__style:{gap:`${4*d}px 0`,overscrollBehavior:_?"none":"auto",scrollbarGutter:H?"stable":void 0,paddingTop:t}},"data-test-id":"aggregated-comment-list",direction:"column",display:"flex",maxHeight:H&&!_?722:"100%",overflow:H?"auto":void 0,width:"100%",children:[l.map((e,t)=>(0,m.jsx)(eo.Fw,{componentType:"pin"===I?13696:13697,impressionAuxFields:{commentId:e.id,pinId:N,pinOwnerUserId:D,pinType:i,parentId:A,parentType:I,commentType:"aggregatedComment"},impressionType:"Comment",loggingId:e.id,slotIndex:t,viewType:p?3:98,children:({impressionTrackerRef:i})=>{let o=t===l.length-1;return(0,m.jsx)(n.xu,{ref:i,dangerouslySetInlineStyle:{__style:{paddingBottom:_&&o?"24px":"0px"}},"data-test-id":"commentThread-comment",tabIndex:0,children:(0,m.jsx)(el,{aggregatedPinDataId:a,closeupAttributionId:D,closeupAttributionUsername:w,comment:e,featuredCommentId:r,inCommentRepRedesignExp:g,inCommentsImprovedDropdownExp:c,inCommentsPopover:_,isDesktop:p,isORBACProfileManager:R,isReadOnly:E,isVideo:L,openOverflowMenu:y,parentId:A,parentType:I,pinId:N,pinnerId:M,reactionListCommentId:k,replyingToCommentId:S,showReactionListForComment:j,showTopCommentHeading:F&&0===t,storyPinDataId:b,toggleEditComposer:v,toggleHelpful:C,toggleLike:f,toggleReplyComposer:T,userAvatarSize:P,viewParameter:G})})}},e.id)),h&&(0,m.jsx)(n.xH,{accessibilityLabel:U._('Comments loading', ' - ', ' -- '),show:h})]}):(0,m.jsx)(n.xu,{alignSelf:"center",width:"100%",children:(0,m.jsx)(n.xH,{accessibilityLabel:U._('Comments loading', ' - ', ' -- '),show:h})})}},624895:function(e,t,i){i.d(t,{Z:()=>s});var n=i(667294),a=i(782259),l=i(785893);let o=(0,n.lazy)(()=>Promise.all([i.e("8907"),i.e("49124"),i.e("50423")]).then(i.bind(i,656379)));function s(e){return(0,l.jsx)(a.Z,{fallback:null,children:(0,l.jsx)(o,{...e})})}},54424:function(e,t,i){i.d(t,{Z:()=>r});var n=i(20256),a=i(762802),l=i(678213),o=i(525839),s=i(785893);function r({onDismiss:e,photo:t}){let i=(0,o.ZP)(),{height:r,url:d,width:c}=t,u=Math.min(r??936,936),m="100vh",_=i._('Close media viewer', 'comments.photo.mediaViewer.close', 'Close media viewer overlay');return(0,s.jsxs)(n.mh,{zIndex:l.b7,children:[(0,s.jsx)(n.iP,{mouseCursor:"zoomOut",onTap:e,children:(0,s.jsxs)(n.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{backgroundColor:"rgba(0, 0, 0, 0.8)"}},"data-test-id":"comment-media-viewer",display:"flex",height:m,justifyContent:"center",left:!0,position:"fixed",right:!0,top:!0,width:"100%",children:[(0,s.jsx)(n.xu,{left:!0,padding:5,position:"absolute",top:!0,children:(0,s.jsx)(n.hU,{accessibilityLabel:_,icon:"cancel",iconColor:"white",onClick:e,padding:3,size:"lg"})}),(0,s.jsx)(n.xu,{dangerouslySetInlineStyle:{__style:{margin:"0 84px"}},height:m,maxHeight:u,width:c,children:d&&(0,s.jsx)(n.Ee,{alt:d??"",fit:"contain",naturalHeight:r??1,naturalWidth:c??1,src:d},d)})]})}),(0,s.jsx)(a.Z,{onClose:e})]})}},545961:function(e,t,i){i.d(t,{Vb:()=>g,ZP:()=>h,mu:()=>p});var n=i(667294),a=i(20256),l=i(767439),o=i(296691),s=i(436873),r=i(54424),d=i(525839),c=i(15667),u=i(647709),m=i(601686),_=i(785893);let g=150,p=346;function h({canEnlargePhoto:e,containerWidth:t,isSelectedPhoto:i,previewPhoto:h,removeSelectedPhoto:E}){let y=(0,d.ZP)(),T=(0,u.HG)(),{isRTL:A}=(0,c.B)(),{setIsMediaViewerOpen:I}=(0,m.x4)(),[S,x]=(0,l.Z)(),[v,C]=(0,n.useState)(!1),[f,O]=(0,n.useState)(!1),[P,R]=(0,n.useState)(null),[L,b]=(0,n.useState)(o.WU),N=(0,s.Z)(h)?h?.url:h?.image_url;(0,n.useEffect)(()=>{(async()=>{N&&!(0,s.Z)(h)&&R(await new Promise((e,t)=>{let i=new Image;i.onload=()=>{e({width:i.width,height:i.height})},i.onerror=t,i.src=N}))})()},[N,h]);let D=(0,s.Z)(h)?h?.width:P?.width,w=(0,s.Z)(h)?h?.height:P?.height,M=D??0,j=w??0,k=N??"",G=Math.min((t||(T?p:312))/M,(T?g:110)/j,1),U=y._('Remove photo', 'photoCommentPreview.removePhoto', 'Icon to remove the selected photo from the comment composer'),H=y._('Photo', 'photoCommentPreview.previewPhoto', 'Photo previewed as part of a comment'),F=e=>{e?x():S(),I(!e),C(!e)};return(0,_.jsxs)(a.xu,{height:G*j,marginTop:3*!!i,position:"relative",width:G*M,children:[(0,_.jsx)(a.iP,{disabled:!e,onMouseEnter:()=>O(!0),onMouseLeave:()=>O(!1),onTap:()=>F(v),children:(0,_.jsx)(a.zd,{rounding:2,children:k&&(0,_.jsx)(a.Ee,{alt:H,color:L,naturalHeight:j,naturalWidth:M,onLoad:()=>{b(o.o),i&&URL.revokeObjectURL(k)},src:k,children:e&&(0,_.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{cursor:"zoom-in",backgroundColor:`rgba(17, 17, 17, ${.4*!!f})`}},height:"100%",width:"100%"})},H)})}),i&&(0,_.jsx)(a.xu,{alignItems:"center",display:"flex",height:24,justifyContent:"center",left:A,marginEnd:-3,marginTop:-3,position:"absolute",right:!A,top:!0,width:24,children:(0,_.jsx)(a.hU,{accessibilityLabel:U,bgColor:"lightGray",icon:"cancel",onClick:E,size:"xs"})}),v&&(0,_.jsx)(r.Z,{onDismiss:()=>F(v),photo:h})]})}},162321:function(e,t,i){i.d(t,{Z:()=>o});var n=i(667294),a=i(20256),l=i(785893);let o=({inCommentFeedPreview:e,isFirstTaggedUserAuthor:t,lineHeight:i,marginBottom:o,marginEnd:s,shouldShowFirstNameOnly:r,size:d,tags:c,taggedUsers:u,text:m})=>{let _=(0,n.useRef)(null),g=(e,t)=>(0,l.jsx)(a.xv,{inline:!0,overflow:"normal",size:d,children:(0,l.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{lineHeight:i,overflowWrap:"anywhere",display:"inline"}},"data-test-id":"text-container",children:e})},t);return(0,l.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{whiteSpace:"pre-wrap",wordWrap:"break-word",marginBottom:o}},children:(()=>{if(!c.length||!u||c.length!==u.length)return g(m,"1");let n=0,o=[];return c.forEach((i,s)=>{let c=m.substring(n,i.offset);n=i.offset+i.length;let _=m.substring(i.offset,n);o=o.concat(g(c,`${s}a`)).concat(((i,n,o,s)=>{let c=r||0===o&&t?u[o].first_name||u[o].username[0]:n;return(0,l.jsx)(a.xv,{color:i,inline:!0,overflow:"normal",size:d,weight:"bold",children:e?c:(0,l.jsx)(a.rU,{display:"inlineBlock",href:`/${u[o].username}`,underline:"hover",children:c})},s)})(i.color,_,s,`${s}b`))}),o=o.concat(g(m.substring(n),"2")),(0,l.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{lineHeight:i}},display:r?"flex":void 0,marginEnd:s??3,position:"relative",children:(0,l.jsx)(a.xv,{ref:_,inline:!0,lineClamp:e?1:void 0,size:d,children:o})})})()})}},296691:function(e,t,i){i.d(t,{A9:()=>p,F1:()=>C,Ff:()=>v,G5:()=>f,G_:()=>x,Gu:()=>S,LH:()=>s,Rv:()=>u,TJ:()=>_,Ty:()=>l,WU:()=>y,XU:()=>c,_q:()=>L,i$:()=>T,iB:()=>o,je:()=>r,mi:()=>O,o:()=>E,pW:()=>g,qJ:()=>b,ql:()=>h,sp:()=>P,uC:()=>d,xA:()=>m,yQ:()=>R,yW:()=>I,zs:()=>A});var n=i(20256),a=i(473728);let l=new n.Ry(3),o=48,s=56,r="sm",d=500,c=1,u=Object.freeze({TOP:0,REPLY_TO_TRIED:1,REPLY_TO_AGGREGATED:2}),m=Object.freeze({PHOTO:0,STICKER:1,PIN:2}),_="comment_featured_ids",g="did_it_featured_ids",p={NONE:"none",WARNING:"warning",BLOCK:"block"},h="https://s.pinimg.com/images/user/default_75.png",E="transparent",y="#efefef",T=(e,t)=>e?(0,a.Z)(t.ngettext('{{ count }} Comment', '{{ count }} Comments', e, 'closeup.commentThread.heading.commentCount', 'Comment count on a Pin. count: number of comments'),{count:e.toString()}):t._('No comments yet', 'closeup.commentThread.heading.noComments', 'Prompt for user to comment on Pin'),A=(e,t,i,n)=>{let a=t.map(t=>({...t,offset:(t.offset||0)+(n?0:e.length+1),color:"shopping"}));return n?a:[{offset:0,length:e.length,color:i?"light":"dark"},...a]},I=e=>e._('Insight heading icon', 'closeupCommentModuleHeading.icon', 'Icon displayed in the comment module heading'),S=e=>e._('No comments yet', 'emptyCommentThread.noComments.heading', 'Text shown when there are no comments yet'),x=e=>e._('Post', 'commentComposer.button.post', 'Post new comment'),v=e=>e._('posted a photo', 'comment.preview.text.photo', 'Comment preview text for an image that a user posted'),C=e=>e._('posted a sticker', 'comment.preview.text.sticker', 'Comment preview text for a sticker that a user posted'),f=e=>e._('Select an emoji', 'emojitray.button.accessibilityLabel', 'Accessibility label for emoji tray button'),O=e=>e._('Select a photo', 'photoModal.button.accessibilityLabel', 'Accessibility label for photo modal button'),P=e=>e._('Select a sticker', 'stickerTray.button.accessibilityLabel', 'Accessibility label for sticker tray button'),R=e=>e._('Text editor', 'EditorWithMentions.container', 'Tappable area for the editor container'),L=e=>e._('Top Comment', 'closeupCommentModuleHeading.heading.topComment', 'Top Comment heading for the comment module'),b=e=>[f(e),O(e),x(e),P(e),R(e)]},436873:function(e,t,i){i.d(t,{Z:()=>n});let n=e=>e?.url!==void 0},607652:function(e,t,i){i.d(t,{Z:()=>d});var n,a=i(667294);i(167912);var l=i(415546),o=i(906498);let s=void 0!==n?n:n=i(673588);function r(e,t){return e&&t?`${e} ${t}w`:null}function d({pinKey:e}){let t=(0,l.Z)(s,e),{anyEnabled:i,group:n}=(0,o.Z)(),d=(0,a.useMemo)(()=>t?.imageSpec_736x||t?.imageSpec_564x||t?.imageSpec_orig||t?.imageSpec_474x||t?.imageSpec_236x,[t]),c=(0,a.useMemo)(()=>{if(!t)return;let e=[r(t.imageSpec_736x?.url,t.imageSpec_736x?.width),r(t.imageSpec_1200x?.url,t.imageSpec_1200x?.width),{enabled:null,enabled_564x:r(t.imageSpec_564x?.url,t.imageSpec_564x?.width),enabled_orig:r(t.imageSpec_orig?.url,t.imageSpec_orig?.width)}[n]].filter(Boolean);return e.length>1?e.join(", "):void 0},[t,n]),u=i?"100cqw":void 0;return(0,a.useMemo)(()=>({mainPinImage:{url:d?.url||"",height:d?.height||1,width:d?.width||1},srcSet:c,srcSizes:u}),[d,c,u])}},906498:function(e,t,i){i.d(t,{Z:()=>o});var n=i(274320),a=i(15667),l=i(647709);let o=({skipExpActivation:e=!1}={})=>{let{checkExperiment:t}=(0,n.FJ)(),i=(0,l.HG)(),{isAuthenticated:o}=(0,a.B)();return o&&i?t("closeup_dweb_adaptive_images",{dangerouslySkipActivation:e}):{anyEnabled:!1,group:""}}},914071:function(e,t,i){i.d(t,{Z:()=>a});var n=i(667294);function a(e,t){let i=(0,n.useRef)([]),[a,l]=(0,n.useState)(),[o,s]=(0,n.useReducer)(a??(()=>t),t),r=(0,n.useCallback)(t=>{a?s(t):(i.current.length||e().then(e=>{l(()=>e.default)}),i.current=[...i.current,t])},[e,a]);return(0,n.useEffect)(()=>{a&&(i.current.forEach(s),i.current=[])},[a]),[o,r]}},105433:function(e,t,i){i.d(t,{pb:()=>T,nf:()=>A,lV:()=>I});var n=i(667294),a=i(581722),l=i(441143),o=i.n(l),s=i(575108),r=i(729434),d=i(686319),c=i(791948),u=i(503246),m=i(991384);let _={feature_map:Object.freeze({})},g=(e,t)=>{let i={...(0,m.Z)(e,t),...t.reaction_counts?{reaction_counts:t.reaction_counts}:Object.freeze({}),...t.tags?{tags:t.tags}:Object.freeze({}),...t.tagged_users?{tagged_users:t.tagged_users}:Object.freeze({})};return(0,u.ZP)(e,i)?e:i},p=(e,t)=>{if(e=e||_,"FETCH_COMPLETE"===t.type){let{payload:{resource:i}}=t,{data:n}=t.payload.response.resource_response;if("AggregatedCommentFeedResource"===i||"AggregatedCommentReplyFeedResource"===i||"DidItCommentsResource"===i){let t=(n||[]).reduce((t,i)=>(t[i.id]=g(e[i.id],i),t),{});return{...e,...t}}if("UnifiedCommentsResource"===i&&n&&n.length>0){let t=n.filter(e=>"aggregatedcomment"===e.type).reduce((t,i)=>(t[i.id]=g(e[i.id],i),t),{});return{...e,...t}}if("UnifiedCommentsPreviewResource"===i&&n&&n.length>0){let t=n.map(e=>e.aggregated_comment).reduce((t,i)=>(i&&(t[i.id]=g(e[i.id],i)),t),{}),i=n.map(e=>e.creator_reply).reduce((t,i)=>(i&&i.id&&(t[i.id]=g(e[i.id],i)),t),{});return{...e,...t,...i}}if("AggregatedCommentFeaturesResource"===i&&n&&Object.keys(n).length>0)return{...e,feature_map:n}}else if("AGGREGATED_COMMENT_CREATED"===t.type){let{payload:{aggregatedComment:i}}=t;return i.id?{...e,[i.id]:i}:e}else if("AGGREGATED_COMMENT_DELETED"===t.type||"AGGREGATED_COMMENT_HIDDEN"===t.type){let{payload:{aggregatedCommentId:i}}=t,n={...e};return delete n[i],n}else if("AGGREGATED_COMMENT_HIDDEN_FOR_USER"===t.type){let{payload:{userId:i}}=t;return Object.fromEntries(Object.entries(e).filter(e=>e[1].user?.id!==i))}else if("AGGREGATED_COMMENT_UPDATED"===t.type){let{payload:{data:i}}=t;return{...e,[i.id]:g(e?.[i.id],i)}}else if("AGGREGATED_COMMENT_LIKE_TOGGLED"===t.type){let{payload:{data:i}}=t,n=e?.[i.id],a=n?.reaction_counts[1]||0,l={1:i.reaction_by_me?a+1:a-1},o={...n,reaction_by_me:i.reaction_by_me,reaction_counts:l};return{...e,[i.id]:o}}else if("AGGREGATED_COMMENT_HELPFUL_TOGGLED"===t.type){let{payload:{data:i}}=t,n=e?.[i.id],a=n?.helpful_count||0,l=i.marked_helpful_by_me?a+1:a-1,o={...n,marked_helpful_by_me:i.marked_helpful_by_me,helpful_count:l};return{...e,[i.id]:o}}else if("AGGREGATED_COMMENT_HIGHLIGHT_TOGGLED"===t.type){let{payload:{data:i}}=t,n={...e?.[i.aggregated_comment_id],highlighted_by_pin_owner:i.is_highlighted};return{...e,[i.aggregated_comment_id]:n}}else if("AGGREGATED_COMMENT_FEATURES_UPDATED"===t.type){let{payload:{data:{featureMap:i}}}=t;return{...e,feature_map:{...e?.feature_map,...i}}}else if("UPDATE_AGGREGATED_COMMENT_COMMENT_COUNT"===t.type){let{payload:{increment:i,id:n}}=t,a=e?.[n];if(!a)return e;let l={...a,comment_count:a.comment_count+i};return{...e,[n]:l}}else if("DELETE_COMMENT_MENTION"===t.type){let{payload:{aggregatedCommentId:i,tagged_users:n}}=t,a={...e?.[i],tagged_users:n};return{...e,[i]:a}}else if("GET_COMMENT_TRANSLATION"===t.type){let{payload:{aggregatedCommentId:i,translatedText:n}}=t,a={...e?.[i],translatedText:n};return{...e,[i]:a}}return e};var h=i(785893);let{Provider:E,get:y}=(0,r.Z)("AggregatedComments");function T({children:e}){let t=(0,a.v9)(({resources:e})=>e?.UnifiedCommentsResource),i=_;t&&Object.values(t).forEach(e=>{let t=e.data?.filter(e=>"aggregatedcomment"===e.type),n=t?.reduce((e,t)=>(e[t.id]=g(i[t.id],t),e),{});i={...i,...n}});let[l,o]=(0,n.useReducer)(p,i),s=e=>{o({type:"FETCH_COMPLETE",payload:e})};(0,c.Z8)("AggregatedCommentFeaturesResource",s),(0,c.my)("AggregatedCommentFeaturesResource",s),(0,c.Z8)("AggregatedCommentFeedResource",s),(0,c.my)("AggregatedCommentFeedResource",s),(0,c.Z8)("AggregatedCommentReplyFeedResource",s),(0,c.my)("AggregatedCommentReplyFeedResource",s),(0,c.Z8)("DidItCommentsResource",s),(0,c.my)("DidItCommentsResource",s),(0,c.Z8)("UnifiedCommentsPreviewResource",s),(0,c.my)("UnifiedCommentsPreviewResource",s),(0,c.Z8)("UnifiedCommentsResource",s),(0,c.my)("UnifiedCommentsResource",s);let r=(0,n.useMemo)(()=>({aggregatedComments:l,dispatch:o}),[l,o]);return(0,h.jsx)(E,{value:r,children:e})}function A(){let{dispatch:e}=y();return(0,n.useMemo)(()=>({aggregatedCommentCreated(t,i){e({type:"AGGREGATED_COMMENT_CREATED",payload:{parentId:t,aggregatedComment:i}})},aggregatedCommentDeleted:(t,i)=>{e({type:"AGGREGATED_COMMENT_DELETED",payload:{parentId:t,aggregatedCommentId:i}})},aggregatedCommentHidden:t=>{e({type:"AGGREGATED_COMMENT_HIDDEN",payload:{aggregatedCommentId:t}})},aggregatedCommentsHiddenForUser:t=>{e({type:"AGGREGATED_COMMENT_HIDDEN_FOR_USER",payload:{userId:t}})},flagAggregatedComment:async({isAggregatedComment:e=!0,commentId:t,reason:i,detailedReasons:n})=>{let a=e?`/v3/aggregated_comments/${t}/flag/`:`/v3/did_it/${t}/flag/`;return(0,d.Z)({url:a,method:"PUT",data:{commentId:t,reason:i,detailedReasons:n}})},deleteCommentMention:async t=>{let{resource_response:i}=await (0,d.Z)({url:`/v3/aggregated_comments/${t}/mentions/`,method:"DELETE",data:{fields:["aggregatedcomment.id","aggregatedcomment.tagged_users"]}}),n=i.data??{};e({type:"DELETE_COMMENT_MENTION",payload:{aggregatedCommentId:n.id,tagged_users:n.tagged_users}})},translateAggregatedComment:async t=>{try{let{resource_response:i}=await (0,d.Z)({url:`/v3/aggregated_comments/${t}/translate/`,method:"GET"}),n=i.data??"";e({type:"GET_COMMENT_TRANSLATION",payload:{aggregatedCommentId:t,translatedText:n}})}catch(i){e({type:"GET_COMMENT_TRANSLATION",payload:{aggregatedCommentId:t,translatedText:""}})}},toggleAggregatedCommentHelpful:({aggregatedCommentId:t,isMarkedHelpfulByMe:i,orbacSubjectId:n})=>{(0,d.Z)({url:`/v3/helpful/1/${t}/`,method:i?"DELETE":"POST",data:n?{orbac_subject_id:n}:{}}),e({type:"AGGREGATED_COMMENT_HELPFUL_TOGGLED",payload:{data:{id:t,marked_helpful_by_me:!i}}})},toggleAggregatedCommentHighlight:async({aggregatedCommentId:t,pinId:i,isHighlighted:n})=>{o()(t,"Could not find comment"),o()(i,"Could not find Pin"),await (0,d.Z)({url:"/v3/aggregated_comments/pin/highlight/",method:"PUT",data:{aggregated_comment:t,pin:i,highlight:!n}}),e({type:"AGGREGATED_COMMENT_HIGHLIGHT_TOGGLED",payload:{data:{aggregated_comment_id:t,pin_id:i,is_highlighted:!n}}})},toggleAggregatedCommentLike:({aggregatedCommentId:t,isLikedByMe:i,orbacSubjectId:n})=>{(0,d.Z)({url:`/v3/aggregated_comments/${t}/react/`,method:i?"DELETE":"POST",data:{reaction_type:1,...n?{orbac_subject_id:n}:{}}}),e({type:"AGGREGATED_COMMENT_LIKE_TOGGLED",payload:{data:{id:t,reaction_by_me:+!i}}})},updateAggregatedComment:async({commentId:t,force:i,orbacSubjectId:n,tags:a,text:l})=>{let{resource_response:o}=await s.Z.create("AggregatedCommentResource",{commentId:t,force:i,tags:a,text:l,...n?{orbacSubjectId:n}:{}}).callUpdate({showError:!1}),{tagged_users:r}=o.data??{};e({type:"AGGREGATED_COMMENT_UPDATED",payload:{data:{id:t,tagged_users:r.map(e=>({...e})),tags:JSON.parse(a),text:l}}})},updateAggregatedCommentFeatures:async({userId:t,featureMap:i,passcode:n,userConfirmPasscode:a})=>{let l={userId:t,featureMap:i,passcode:n,user_confirm_skip_passcode:a};void 0===a&&(l.user_confirm_skip_passcode=!1);let{resource_response:o}=await s.Z.create("AggregatedCommentFeaturesResource",l).callUpdate({showError:!1});e({type:"AGGREGATED_COMMENT_FEATURES_UPDATED",payload:{data:{featureMap:o.data??Object.freeze({})}}})},updateCommentCount:(t,i)=>{e({type:"UPDATE_AGGREGATED_COMMENT_COMMENT_COUNT",payload:{increment:i,id:t}})}}),[e])}function I(){let{aggregatedComments:e}=y();return e}},502066:function(e,t,i){i.d(t,{G:()=>m,Kl:()=>_,vo:()=>u});var n=i(667294),a=i(729434),l=i(791948),o=i(914071),s=i(785893);let r=()=>i.e("83726").then(i.bind(i,3571)),{Provider:d,get:c}=(0,a.Z)("NativeEngagements");function u({children:e}){let[t,i]=(0,o.Z)(r,[]);(0,l.Z8)("NativeInteractionsResource",e=>{i({type:"FETCH_COMPLETE",payload:e})}),(0,l.my)("NativeInteractionsResource",e=>{i({type:"FETCH_MORE_COMPLETE",payload:e})});let a=(0,n.useMemo)(()=>({dispatch:i,nativeEngagements:t}),[i,t]);return(0,s.jsx)(d,{value:a,children:e})}function m(){let{dispatch:e}=c();return(0,n.useMemo)(()=>({nativeEngagementsHiddenForUser:t=>{e({type:"NATIVE_ENGAGEMENT_HIDDEN_FOR_USER",payload:{userId:t}})}}),[e])}function _(){let{nativeEngagements:e}=c();return e}},790427:function(e,t,i){i.d(t,{$8:()=>c,Dk:()=>d,Fk:()=>a,fS:()=>r,lI:()=>l,mS:()=>s,qW:()=>o});var n=i(20256);let a=new n.Ry(1),l=new n.Ry(3),o=2,s=new n.Ry(o),r=3,d=new n.Ry(100),c=new n.H3([d])},370347:function(e,t,i){i.d(t,{Yg:()=>r,ib:()=>c,nF:()=>m,xX:()=>u});var n=i(274320),a=i(15667),l=i(647709),o=i(603316);let s=({checkExperiment:e})=>{let{group:t}=e("auth_mweb_graphql_pin_page",{dangerouslySkipActivation:!0});return{logStat:(e,i)=>(0,o.nP)("webapp.graphql.debug_auth_mweb_graphql_pin_page",{sampleRate:1,tags:{event:e,group:t,...i}})}},r=()=>{let{isAuthenticated:e}=(0,a.B)(),t=(0,l.HG)(),{checkExperiment:i}=(0,n.ru)();return e&&!t?s({checkExperiment:i}):{logStat:()=>{}}},d=0,c=({checkExperiment:e,isAuthMweb:t})=>{if(!t)return;let{logStat:i}=s({checkExperiment:e});(d+=1)<10&&i(`repin_${d}`)};function u({checkExperiment:e,isDesktop:t,isAuthenticated:i}){if(!i)return{isGraphQLEnabledInGeneral:!0,isGraphQLEnabledForRelatedPins:!0};if(t){let{anyEnabled:t}=e("auth_dweb_graphql_pin_page");return{isGraphQLEnabledForRelatedPins:t,isGraphQLEnabledInGeneral:t}}{let{anyEnabled:t,group:i}=e("auth_mweb_graphql_pin_page");switch(i){case"control":return{isGraphQLEnabledInGeneral:!1,isGraphQLEnabledForRelatedPins:!1};case"enabled":return{isGraphQLEnabledInGeneral:!0,isGraphQLEnabledForRelatedPins:!0};case"only_closeup":return{isGraphQLEnabledInGeneral:!0,isGraphQLEnabledForRelatedPins:!1};case"only_related_pins":return{isGraphQLEnabledInGeneral:!1,isGraphQLEnabledForRelatedPins:!0};default:return{isGraphQLEnabledInGeneral:t,isGraphQLEnabledForRelatedPins:t}}}}function m(){let{checkExperiment:e}=(0,n.ru)(),t=(0,l.HG)(),{isAuthenticated:i}=(0,a.B)();return u({checkExperiment:e,isDesktop:t,isAuthenticated:i})}},934603:function(e,t,i){i.d(t,{B:()=>x,Z:()=>f});var n,a=i(667294),l=i(581722);i(167912);var o=i(616550),s=i(20256),r=i(780734),d=i(821342),c=i(415546),u=i(886981),m=i(647709),_=i(341742),g=i(448505),p=i(7872),h=i(105433),E=i(542092),y=i(716751),T=i(611134),A=i(32082),I=i(793698),S=i(785893);let x=({aggregatedPinDataId:e,featuredCommentIds:t,featuredDidItIds:i,isDesktop:n,isReversed:a=!1,noCache:l=!1,orbacSubjectId:o=""})=>({name:"UnifiedCommentsResource",options:{aggregated_pin_id:e,comment_featured_ids:t,did_it_featured_ids:i,page_size:n?10:25,redux_normalize_feed:!0,is_reversed:a,...o?{orbac_subject_id:o}:{}},noCache:l}),v=void 0!==n?n:n=i(316387),C=({aggregatedPinDataId:e,inCommentRepRedesignExp:t,closeupAttributionId:i,closeupAttributionUsername:n,commentsDisabled:c,hasComments:v,isReadOnly:C,pinId:f,isVideo:O,pinnerId:P,scrollContainer:R,setIsComposingNewComment:L=()=>{},showingCloseupCommentModule:b,storyPinDataId:N,viewParameter:D,toggleComposerForReply:w,openMwebOverflowMenu:M})=>{let{comment_id:j}=(0,o.UO)(),k=(0,l.I0)(),G=(0,m.HG)(),U=(0,d.Z)(),H=(0,a.useRef)(v),F=(0,g.Z)(),z=(0,p.lJ)(U,F),V=(0,u.Z)(H.current&&e?x({aggregatedPinDataId:e,featuredCommentIds:j?[j]:[],isDesktop:G}):null),{removeUnauthCommentPinId:Z,unauthCommentPinId:B}=(0,y.o)(),K=(0,h.lV)(),{toggleAggregatedCommentHelpful:W,toggleAggregatedCommentLike:$}=(0,h.nf)(),Y=(0,I.dM)(),q=(0,l.v9)(t=>(0,A.Z)(t,{aggregatedPinDataId:e,aggregatedComments:K,users:Y})),[Q,J]=(0,a.useState)(void 0);return(0,_.Z)(()=>{!G&&U.isAuth&&B&&f&&B===f&&(L(!0),Z())}),(0,a.useEffect)(()=>{let e=()=>{let t=!!R&&R.scrollTop+R.clientHeight+10>=R.scrollHeight;V&&!V.isFetching&&(V.isAtEnd?R?.removeEventListener("scroll",e):t&&V.fetchMore())};return R?.addEventListener("scroll",e),()=>{R?.removeEventListener("scroll",e)}},[V,R]),(0,S.jsx)(a.Fragment,{children:(0,S.jsx)(s.xu,{display:"flex",height:t&&0===q.length?"100%":void 0,marginTop:G?6:2*!!t,width:"100%",children:(0,S.jsx)(r.Z,{aggregatedPinDataId:e,closeupAttributionId:i,closeupAttributionUsername:n,comments:q,commentsDisabled:c,inCommentRepRedesignExp:t,isDesktop:G,isReadOnly:C,isVideo:O,openOverflowMenu:M,parentId:e??"",parentType:E.o.pin,pinId:f,pinnerId:P,reactionListCommentId:Q,showingCloseupCommentModule:b,showReactionListForComment:J,storyPinDataId:N,toggleHelpful:(e,t,i)=>()=>{i?k((0,T.YH)({didItDataId:e,isMarkedHelpfulByMe:t,orbacSubjectId:z})):W({aggregatedCommentId:e,isMarkedHelpfulByMe:t,orbacSubjectId:z})},toggleLike:(e,t,i)=>()=>{i?k((0,T.wH)({didItDataId:e,isLikedByMe:t,orbacSubjectId:z})):$({aggregatedCommentId:e,isLikedByMe:t,orbacSubjectId:z})},toggleReplyComposer:w,userAvatarSize:"sm",viewParameter:D})})})};function f({pinKey:e,...t}){let i=(0,c.Z)(v,e),n=(i?.aggregatedPinData?.commentCount||0)+(i?.aggregatedPinData?.didItData?.imagesCount||0);return(0,S.jsx)(C,{aggregatedPinDataId:i?.aggregatedPinData?.entityId,closeupAttributionId:i?.closeupAttribution?.entityId,closeupAttributionUsername:i?.closeupAttribution?.username,commentsDisabled:i?.commentsDisabled,disablePhotoCommentSelection:!!i?.doneByMe,hasComments:n>0&&!i?.commentsDisabled,isVideo:!!i?.videos?.videoList,pinId:i?.entityId,pinnerId:i?.pinner?.entityId,storyPinDataId:i?.storyPinData?.entityId,...t})}},716751:function(e,t,i){i.d(t,{o:()=>s,p:()=>r});var n=i(667294),a=i(729434),l=i(785893);let{Provider:o,get:s}=(0,a.Z)("Session");function r({children:e}){let[t,i]=(0,n.useState)(void 0),a=(0,n.useCallback)(()=>i(void 0),[]),s=(0,n.useMemo)(()=>({unauthCommentPinId:t,setUnauthCommentPinId:i,removeUnauthCommentPinId:a}),[t,a]);return(0,l.jsx)(o,{value:s,children:e})}},620427:function(e,t,i){i.d(t,{Z:()=>n});function n(e,t){e&&e.includes("~0")&&(e=e.replace("~0",""));let i=t?.includes("~0")?t:`${t||""}~0`;return e&&e.replace("undefined","")?e:i.replace("undefined","")}},32082:function(e,t,i){i.d(t,{Z:()=>o});var n=i(442279),a=i(696323);let l={},o=(0,n.createSelector)((e,{aggregatedComments:t})=>t,({feeds:e},{aggregatedPinDataId:t})=>e[`${a.Z.UNIFIED_COMMENTS}:${t||""}`],({didItData:e})=>e,(e,{users:t})=>t??l,(e,t,i,n)=>{let a=new Set;return t?.map(({id:t,type:o})=>{if(a.has(t))return;a.add(t);let s="aggregatedcomment"===o.toLowerCase()?e[t]:i[t];if(!s)return;let r="user"in s&&("string"==typeof s.user?n[s.user]??l:s.user??l);return{...s,user:r??l}}).filter(e=>void 0!==e)||[]})},333651:function(e){e.exports="https://s.pinimg.com/webapp/commentHelpful-99007872.svg"},773655:function(e){e.exports="https://s.pinimg.com/webapp/commentLoved-7942dc4f.svg"}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/34306-84863180c4a40ce8.mjs.map